library(readr)
UniversalBank <- read_csv("Documents/GitHub/Sbandhan_64060/Assignment2/UniversalBank.csv")
View(UniversalBank)
install.packages(lsr)
install.packages("lsr")
library(lsr)
install.packages("caret")
library(caret)
head(UniversalBank)
summary(UniversalBank)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
#loading all the required libraries
library(e1071)
library(dplyr)
library(caret)
library(ISLR)
library(FNN)
library(gmodels)
library(dummies)
UB<-read.csv("D:/MACHINE LEARNING/UniversalBank.csv")
install.packages("dplyr")
install.packages("Caret")
install.packages("caret")
install.packages("ISLR")
install.packages("gmodels")
install.packages("dummies")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
#loading all the required libraries
library(dplyr)
library(caret)
library(ISLR)
library(FNN)
library(gmodels)
library(dummies)
UB<-read.csv("D:/MACHINE LEARNING/UniversalBank.csv")
UB<-read.csv("UniversalBank.csv")
UB<-read.csv("UniversalBank.csv")
ub<-read.csv("UniversalBank.csv")
UNBank<-read.csv("UniversalBank.csv")
edu_dummy_model <- dummy(Bank$Education)
UBank <- tmp[c(-6)]
set.seed(20)
Index <- createDataPartition(UBank$Income, p= 0.6, list = FALSE)
norm_model<-preProcess(training_data, method = c("center","scale"))
TestTraining_Data <- c(40, 10, 84, 2, 2, 0, 0, 0, 1, 1, 0, 1, 0)
knn_test <- knn(train_data,TestTraining_Data,cl=train_outcome,k=1,prob = TRUE)
bestk <- data.frame(k = seq(1,55,1), accuracy = rep (0, 55))
head(bestk)
for (i in 1:55){
knn.pred <- knn(train_data, valida_data, cl=train_outcome, k=i)
bestk[i,2] <- confusionMatrix(knn.pred, validation_outcome)$overall[1]
}
knn.pred <- knn(train_data, valida_data, cl=train_outcome, k=bestk_fit$k, prob = TRUE)
TestTraining_Data <- c(40, 10, 84, 2, 2, 0, 0, 0, 1, 1, 0, 1, 0)
bestfitknn <- knn(train_data, TestTraining_Data, cl=train_outcome, k =bestk_fit$k, prob = TRUE)
IndexNew1 <- createDataPartition(UBank$Income, p = 0.5, list = FALSE)
norm_values2 <- preProcess(training_data2, method = c ("center", "scale"))
Knn_validation <- knn(train_data2, valida_data2, cl=training_outcome2, k= bestk_fit$k, prob = TRUE)
Knn_testing <- knn(train_data2, TestTraining_Data2, cl=training_outcome2, k =bestk_fit$k, prob = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
library(readr)
library(dplyr)
library(fastDummies)
install.packages("fastDummies")
library(readr)
library(dplyr)
library(fastDummies)
library(caret)
library(class)
ub_dataset <- read_csv("UniversalBank.csv")
install.packages("ggplot2")
install.packages("lattice")
library(readr)
library(dplyr)
library(fastDummies)
library(caret)
library(class)
ub_dataset <- read_csv("UniversalBank.csv")
library(ggplot2)
library(lattice)
library(readr)
library(dplyr)
library(fastDummies)
library(caret)
library(class)
ub_dataset <- read_csv("UniversalBank.csv")
#removing ID and ZipCode Columns from Dataset
ub_dataset <- ub_dataset[,c(-1,-5)]
set.seed(300)
index <- createDataPartition(ub_dataset_d$`Personal Loan`, p=0.6, list = FALSE)
library(readr)
library(dplyr)
library(fastDummies)
library(caret)
library(class)
unbank_dataset <- read_csv("UniversalBank.csv")
bank_dataset <- read_csv("UniversalBank.csv")
universal_dataset <- read_csv("UniversalBank.csv")
knitr::opts_chunk$set(echo = TRUE)
#Setting up Working Directory and importing dataset
setwd("D:\\Study\\Assignments\\MachLearn\\MachLearnAssignment2")
knitr::opts_chunk$set(echo = TRUE)
#Setting up Working Directory and importing dataset
unibank_main<-read.csv("UniversalBank.csv")
knitr::opts_chunk$set(echo = TRUE)
#loading all the required packages by using library function
library(dplyr)
library(caret)
library(class)
library(kknn)
library(ISLR)
library(FNN)
library(gmodels)
library(dummies)
UnBank<-read.csv("UniversalBank.csv")
# Removing ID and ZIPCODE attributes
ub<-UnBank[,c(-1,-5)]
str(ub)
Education_dummy_model<-dummy(UnBank$Education)
tmp<-cbind(ub,Education_dummy_model)
head(tmp)
withBank <-tmp[c(-6)]
head(withBank)
set.seed(18)
Index<-createDataPartition(withBank$Income,p=0.6,list=FALSE)
train_data<-withBank[Index,]
dim(train_data)
valid_data<-withBank [-Index ,]
dim(valid_data)
summary(train_data)
summary(valid_data)
norm_model<-preProcess(train_data, method =c("center","scale"))
head(norm_model)
training_nf<-predict(norm_model,train_data)
validation_nf<-predict(norm_model,valid_data)
total_nf<-predict(norm_model,withBank)
summary(total_nf)
summary(training_nf)
summary(validation_nf)
set.seed(18)
training_data<-training_nf[,-5]
head(training_data)
train_outcome<-factor(train_data[,5],levels=c(0,1), labels=c("Accepted","Refused"))
head(train_outcome)
valid1_data <-validation_nf[,-5]
head(valid1_data)
validation_outcome<-factor(valid_data[,5],levels = c(0,1), labels = c("Accepted","Refused"))
head(validation_outcome)
total_data<-total_nf[,-5]
total_outcome<-factor(withBank[,5], levels = c(0,1),labels = c("Accepted","Refused"))
head(total_outcome)
ggplot(valid_data,aes(x=Age, y=Experience)) + geom_point()
ggplot(valid_data,aes(x=Income)) + geom_histogram()
ggplot(valid_data,aes(x=Experience,y=Income)) + geom_point()
test_data <- data.frame (Age = 40, Experience = 10, Income = 84, Family = 2, CCAvg = 2, Education_1 = 0, Education_2 = 1, Education_3 = 0, Mortgage = 0, Securities.Account = 0, CD.Account = 0, Online = 1,  CreditCard=1,stringsAsFactors = FALSE)
test_data
library(caret)
library(kknn)
set.seed(100)
finestk<-data.frame(k=seq(1,30,1),  accuracy=rep(0,30))
head(finestk)
for (i in 1:30) {
knn.pred<-knn(training_data,valid1_data, cl=train_outcome,k=i)
finestk[i,2]<-confusionMatrix(knn.pred,validation_outcome)$ovearall[1]
}
library(caret)
library(kknn)
set.seed(100)
finestk<-data.frame(k=seq(1,30,1),  accuracy=rep(0,30))
head(finestk)
for (i in 1:30) {
knn.pred<-knn(training_data,valid1_data, cl=train_outcome,k=i)
finestk[i,2]<-confusionMatrix(knn.pred,validation_outcome)$ovearall[1]
}
knn.pred <-knn(train_data,valid_data,cl=train_outcome,k=finestk$k,prob=TRUE)
TestTraining_Data<-c(40, 10,  8, 2, 2,0,0 ,0, 1, 1, 0, 1, 0)
bestfitknn<-knn(train_data,TestTraining_Data,cl=train_outcome,k=finestk$k,prob=TRUE)
IndexNew1<-createDataPartition(UnBank$Income,p=0.5,list = FALSE)
training_data2=UnBank[IndexNew1,]
Remdata<-UnBank[-IndexNew1,]
IndexNew2<-createDataPartition(UnBank$Income,p=0.6,list =FALSE)
valid_data2 <- Remdata[IndexNew2,]
test_data2<-Remdata[-IndexNew2,]
head(test_data2)
norm_value2<-preProcess(training_data2,method = c("center","scale"))
training_nf2<-predict(norm_value2,training_data2)
validation_nf2<-predict(norm_value2,valid_data2)
test_nf2<-predict(norm_value2,test_data2)
total_nf2<-predict(norm_value2,UnBank)
training_data2<- training_nf2[-7]
train_outcome2 <- factor(training_data2[-7], levels = c(0,1),labels = "Accepted","Refused")
valid_data2<-validation_nf2[-7]
validation_outcome2<-factor(valid_data2[,7], levels=c(0,1), labels = "Accepted","Refused")
TestTraining_Data2<-test_nf2[,-7]
TestTraining_outcome2<-factor(test_data2[,-7],levels = c(0,1),labels("Accepted","Refused"))
Total_Data2<-total_nf2[,-7]
Total_outcome2<-factor (UnBank[,7], levels=c(0,1), labels=c ("Accepted","Refused"))
knn_testing <-knn (training_data2,TestTraining_Data2,cl=train_outcome2, k=finestk_fit$k, prob = TRUE)
knn_total<-knn(training_data2,Total_Data2, cl=train_outcome2, k=finestk$k, prob=TRUE)
knitr::opts_chunk$set(echo = TRUE)
#loading all the required packages by using library function
library(dplyr)
library(caret)
library(class)
library(kknn)
library(ISLR)
library(FNN)
library(gmodels)
library(dummies)
UnBank<-read.csv("UniversalBank.csv")
# Removing ID and ZIPCODE attributes
ub<-UnBank[,c(-1,-5)]
str(ub)
Education_dummy_model<-dummy(UnBank$Education)
tmp<-cbind(ub,Education_dummy_model)
head(tmp)
withBank <-tmp[c(-6)]
head(withBank)
set.seed(18)
Index<-createDataPartition(withBank$Income,p=0.6,list=FALSE)
train_data<-withBank[Index,]
dim(train_data)
valid_data<-withBank [-Index ,]
dim(valid_data)
summary(train_data)
summary(valid_data)
norm_model<-preProcess(train_data, method =c("center","scale"))
head(norm_model)
training_nf<-predict(norm_model,train_data)
validation_nf<-predict(norm_model,valid_data)
total_nf<-predict(norm_model,withBank)
summary(total_nf)
summary(training_nf)
summary(validation_nf)
set.seed(18)
training_data<-training_nf[,-5]
head(training_data)
train_outcome<-factor(train_data[,5],levels=c(0,1), labels=c("Accepted","Refused"))
head(train_outcome)
valid1_data <-validation_nf[,-5]
head(valid1_data)
validation_outcome<-factor(valid_data[,5],levels = c(0,1), labels = c("Accepted","Refused"))
head(validation_outcome)
total_data<-total_nf[,-5]
total_outcome<-factor(withBank[,5], levels = c(0,1),labels = c("Accepted","Refused"))
head(total_outcome)
ggplot(valid_data,aes(x=Age, y=Experience)) + geom_point()
ggplot(valid_data,aes(x=Income)) + geom_histogram()
ggplot(valid_data,aes(x=Experience,y=Income)) + geom_point()
test_data <- data.frame (Age = 40, Experience = 10, Income = 84, Family = 2, CCAvg = 2, Education_1 = 0, Education_2 = 1, Education_3 = 0, Mortgage = 0, Securities.Account = 0, CD.Account = 0, Online = 1,  CreditCard=1,stringsAsFactors = FALSE)
test_data
library(caret)
library(kknn)
set.seed(100)
finestk<-data.frame(k=seq(1,30,1),  accuracy=rep(0,30))
head(finestk)
for (i in 1:30) {
knn.pred<-knn(training_data,valid1_data, cl=train_outcome,k=i)
finestk[i,2]<-confusionMatrix(knn.pred,validation_outcome)$ovearall[1]
}
knitr::opts_chunk$set(echo = TRUE)
#Setting up Working Directory and importing dataset
setwd("D:\\Study\\Assignments\\MachLearn\\MachLearnAssignment2")
#Setting up Working Directory and importing dataset
unibank_main<-read.csv("UniversalBank.csv")
setwd("~/")
#Setting up Working Directory and importing dataset
unibank_main<-read.csv("UniversalBank.csv")
setwd("~/")
#Setting up Working Directory and importing dataset
unibank_main<-read.csv("UniversalBank.csv")
#Setting up Working Directory and importing dataset
setwd("D:\\Study\\Assignments\\MachLearn\\MachLearnAssignment2")
unibank_main<-read.csv("UniversalBank.csv")
UnBank<-read.csv("UniversalBank.csv")
setwd("~/Documents/GitHub/Sbandhan_64060/Assignment2")
knitr::opts_chunk$set(echo = TRUE)
UnBank<-read.csv("UniversalBank.csv")
head(unibank_main)
UnBank<-read.csv("UniversalBank.csv")
head(unibank_main)
